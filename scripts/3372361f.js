document.addEventListener("DOMContentLoaded",(function(){const e=$.qs("#tt"),t=$.qs("#il"),c=$.qs("#sr"),o=$.qs("#se"),a=$.qs("#to"),r=$.qs("#si"),l=$.qs("#t"),n=$.qs("#ts"),s=$.qs("#detailedBreakdownReport"),u=$.qs("#investmentBreakdownTable"),i=$.qs("#rb"),d=$.qs("#_"),v=$.qsa(".stockavgcal__mode-input"),_=$.qs(".stockavgcal__advanced-paramters");function y(){for(const e of v)if(e.checked)return e.value;return null}function g(e){"basic"===(e=e||y())?_.classList.add("np"):_.classList.remove("np")}function q(e=1){if(e>=1&&e<=10)return["First","Second","Third","Fourth","Fifth","Sixth","Seventh","Eighth","Ninth","Tenth"][e-1];const t=(()=>{const t=e%10,c=e%100;return 1===t&&11!==c?"st_conflict":2===t&&12!==c?"nd_conflict":3===t&&13!==c?"rd_conflict":"th"})();return`${e}${t}`}function S(){const e=$.qs(".hp");let t=q(e.children.length+1);const c=$.qs(".hd").cloneNode(!0),o=c.querySelector(".stockavgcal__purchase-heading"),a=document.createElement("img");a.classList.add("stockavgcal__purchase-remove"),a.setAttribute("src","/assets/images/a6d3e123.svg"),o.textContent=`${t} Purchase`,o.after(a),a.addEventListener("click",(()=>{e.removeChild(c),function(){const e=$.qsa(".hd");for(let t=0;t<e.length;t++){const c=e[t],o=c.querySelector(".stockavgcal__purchase-heading");let a=q(t+1);o.textContent=`${a} Purchase`,a=a.toLowerCase(),c.querySelector(".stockavgcal__purchase-label--buy-price").setAttribute("for",`${a}-purchase`),c.querySelector(".stockavgcal__purchase-buy-price").id=`${a}-purchase`,c.querySelector(".stockavgcal__purchase-label--quantity").setAttribute("for",`${a}-quantity`),c.querySelector(".stockavgcal__purchase-quantity").id=`${a}-quantity`}}(),m()})),t=t.toLowerCase(),c.querySelector(".stockavgcal__purchase-label--buy-price").setAttribute("for",`${t}-purchase`),c.querySelector(".stockavgcal__purchase-buy-price").id=`${t}-purchase`,c.querySelector(".stockavgcal__purchase-label--quantity").setAttribute("for",`${t}-quantity`),c.querySelector(".stockavgcal__purchase-quantity").id=`${t}-quantity`,c.querySelector(".stockavgcal__purchase-buy-price").value=0,c.querySelector(".stockavgcal__purchase-quantity").value=0,e.appendChild(c)}function p(e){const t=$.qsa(".stockavgcal__preferred-currency");for(let c=0;c<t.length;c++){t[c].textContent=e}}function m(){const e=y(),l=$.qsa(".hd");let i=0,d=0;const v=[];for(const e of l){const t=e.querySelector(".stockavgcal__purchase-buy-price"),c=e.querySelector(".stockavgcal__purchase-quantity"),o=parseFloat(t.value||0),a=parseFloat(c.value||0);i+=a,d+=o*a,v.push({buyPrice:o,quantity:a,invested:(o*a).toFixed(2)})}if(!d||!i)return;const _=Number((i>0?d/i:0).toFixed(2)).toLocaleString(),g=Number(i.toFixed(2)).toLocaleString(),q=Number(d.toFixed(2)).toLocaleString();t.textContent=_,c.textContent=g,o.textContent=q;const S=parseFloat(n.value||0);if(S>0&&i>0){const e=S*i-d,t=e/d*100;a.textContent=`${e>=0?"+":""}${Number(e.toFixed(2)).toLocaleString()}`,r.textContent=`${t>=0?"+":""}${Number(t.toFixed(2)).toLocaleString()}%`,a.classList.toggle("in-profit",e>0),a.classList.toggle("in-loss",e<0),r.classList.toggle("in-profit",t>0),r.classList.toggle("in-loss",t<0),a.closest(".hk").classList.remove("np"),r.closest(".hk").classList.remove("np")}else a.closest(".hk").classList.add("np"),r.closest(".hk").classList.add("np");const p=u.querySelector(".stockavgcal__table-header"),m=u.querySelectorAll(".stockavgcal__table-row");for(let e=1;e<m.length;e++)m[e].remove();let h=0;const k=m[0];for(let t=0;t<v.length;t++){const c=v[t],o=k.cloneNode(!0),a=k.cloneNode(!0);let r=0;if(t===v.length-1?r=Number((100-h).toFixed(2)):d>0&&(r=(c.invested/d*100).toFixed(2),h+=Number(r)),o.querySelector(".stockavgcal__purchase-num-value").textContent=t+1,o.querySelector(".stockavgcal__buy-price-value").textContent=c.buyPrice.toLocaleString(),o.querySelector(".stockavgcal__quantity-value").textContent=c.quantity.toLocaleString(),o.querySelector(".stockavgcal__invested-value").textContent=Number(c.invested).toLocaleString(),"basic"===e?(p.querySelector(".stockavgcal__allocation-column").classList.add("np"),o.querySelector(".stockavgcal__allocation-value").classList.add("np")):(o.querySelector(".stockavgcal__allocation-value").classList.remove("np"),o.querySelector(".stockavgcal__allocation-value").textContent=`${Number(r)}%`,p.querySelector(".stockavgcal__allocation-column").classList.remove("np")),S>0){const e=(S*c.quantity).toFixed(2),t=(e-c.invested).toFixed(2),a=(t/c.invested*100).toFixed(2);p.querySelector(".stockavgcal__current-column").classList.remove("np"),p.querySelector(".stockavgcal__pl-column").classList.remove("np"),p.querySelector(".stockavgcal__net-change-column").classList.remove("np"),o.querySelector(".stockavgcal__current-value").classList.remove("np"),o.querySelector(".stockavgcal__pl-value").classList.remove("np"),o.querySelector(".stockavgcal__net-change-value").classList.remove("np"),o.querySelector(".stockavgcal__current-value").textContent=Number(e).toLocaleString(),o.querySelector(".stockavgcal__pl-value").textContent=`${t>=0?"+":""}${Number(t).toLocaleString()}`,o.querySelector(".stockavgcal__net-change-value").textContent=`${a>=0?"+":""}${Number(a).toLocaleString()}%`}else p.querySelector(".stockavgcal__current-column").classList.add("np"),p.querySelector(".stockavgcal__pl-column").classList.add("np"),p.querySelector(".stockavgcal__net-change-column").classList.add("np"),o.querySelector(".stockavgcal__current-value").classList.add("np"),o.querySelector(".stockavgcal__pl-value").classList.add("np"),o.querySelector(".stockavgcal__net-change-value").classList.add("np");u.appendChild(o),a.querySelector(".stockavgcal__buy-price-value").textContent=_,a.querySelector(".stockavgcal__quantity-value").textContent=g,a.querySelector(".stockavgcal__invested-value").textContent=q}k.remove(),s.classList.remove("np")}$.qs("#z").addEventListener("submit",(function(e){e.preventDefault();const t=$.qs("#tp").value;/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/.test(t)?window.location.href="/contact-us.html?email="+encodeURIComponent(t):alert("Please enter a valid email address.")})),g(),function(){e.addEventListener("change",(e=>{const t=e.target.value;t&&sessionStorage.setItem("currency-preference",t),p(t)})),l.addEventListener("click",(()=>{S()})),d.addEventListener("click",(()=>{m()})),i.addEventListener("click",(()=>{!function(){const e=$.qsa(".hd");for(const t of e){const e=t.querySelector(".stockavgcal__purchase-buy-price"),c=t.querySelector(".stockavgcal__purchase-quantity");e.value=0,c.value=0}t.textContent=0,c.textContent=0,o.textContent=0,n.value=0,a.closest(".hk").classList.add("np"),r.closest(".hk").classList.add("np"),s.classList.add("np");const l=u.querySelectorAll(".stockavgcal__table-row");for(let e=1;e<l.length;e++)l[e].remove()}()}));for(const e of v)e.addEventListener("change",(e=>{g(e.target.value)}));const _=sessionStorage.getItem("currency-preference");_&&(e.value=_,p(_))}()}));