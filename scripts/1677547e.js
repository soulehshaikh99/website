document.addEventListener("DOMContentLoaded",(function(){const e=$.qs("#tt"),t=$.qs("#if"),c=$.qs("#st"),o=$.qs("#iz"),r=$.qs("#to"),l=$.qs("#sn"),n=$.qs("#t"),a=$.qs("#ts"),u=$.qs("#tp"),s=$.qs(".stockavgcal-output__investment-breakdown"),i=$.qs(".stockavgcal-output__portfolio-summary"),g=$.qs(".stockavgcal-output__breakeven-metrics"),v=$.qs(".stockavgcal-output__price-insights"),d=$.qs("#ry"),y=$.qs("#_"),_=$.qsa(".stockavgcal__mode-input"),S=$.qs(".stockavgcal__advanced-paramters");function q(){for(const e of _)if(e.checked)return e.value;return null}function m(e){"basic"===(e=e||q())?$.conceal(r.closest(".hk"),l.closest(".hk"),S):$.reveal(S),$.conceal(u)}function h(e=1){if(e>=1&&e<=10)return["First","Second","Third","Fourth","Fifth","Sixth","Seventh","Eighth","Ninth","Tenth"][e-1];const t=(()=>{const t=e%10,c=e%100;return 1===t&&11!==c?"st_conflict":2===t&&12!==c?"nd_conflict":3===t&&13!==c?"rd_conflict":"th"})();return`${e}${t}`}function p(){const e=$.qs(".hp");let t=h(e.children.length+1);const c=$.qs(".hd").cloneNode(!0),o=c.querySelector(".stockavgcal__purchase-heading"),r=document.createElement("img");r.classList.add("stockavgcal__purchase-remove"),r.setAttribute("src","/assets/images/a6d3e123.svg"),o.textContent=`${t} Purchase`,o.after(r),r.addEventListener("click",(()=>{e.removeChild(c),function(){const e=$.qsa(".hd");for(let t=0;t<e.length;t++){const c=e[t],o=c.querySelector(".stockavgcal__purchase-heading");let r=h(t+1);o.textContent=`${r} Purchase`,r=r.toLowerCase(),c.querySelector(".stockavgcal__purchase-label--buy-price").setAttribute("for",`${r}-purchase`),c.querySelector(".stockavgcal__purchase-buy-price").id=`${r}-purchase`,c.querySelector(".stockavgcal__purchase-label--quantity").setAttribute("for",`${r}-quantity`),c.querySelector(".stockavgcal__purchase-quantity").id=`${r}-quantity`}}(),f()})),t=t.toLowerCase(),c.querySelector(".stockavgcal__purchase-label--buy-price").setAttribute("for",`${t}-purchase`),c.querySelector(".stockavgcal__purchase-buy-price").id=`${t}-purchase`,c.querySelector(".stockavgcal__purchase-label--quantity").setAttribute("for",`${t}-quantity`),c.querySelector(".stockavgcal__purchase-quantity").id=`${t}-quantity`,c.querySelector(".stockavgcal__purchase-buy-price").value=0,c.querySelector(".stockavgcal__purchase-quantity").value=0,e.appendChild(c)}function k(e){const t=$.qsa(".stockavgcal__preferred-currency");for(let c=0;c<t.length;c++){t[c].textContent=e}}function f(){const e=q(),n=$.qsa(".hd");let g=0,v=0;const d=[];for(const e of n){const t=e.querySelector(".stockavgcal__purchase-buy-price"),c=e.querySelector(".stockavgcal__purchase-quantity"),o=parseFloat(t.value||0),r=parseFloat(c.value||0);g+=r,v+=o*r,d.push({buyPrice:o,quantity:r,invested:(o*r).toFixed(2)})}if(!v||!g)return;const y=Number((g>0?v/g:0).toFixed(2)).toLocaleString(),_=Number(g.toFixed(2)).toLocaleString(),S=Number(v.toFixed(2)).toLocaleString();t.textContent=y,c.textContent=_,o.textContent=S;const m=parseFloat(a.value||0);if(m>0&&g>0){const e=m*g-v,t=e/v*100;r.textContent=`${e>=0?"+":""}${Number(e.toFixed(2)).toLocaleString()}`,l.textContent=`${t>=0?"+":""}${Number(t.toFixed(2)).toLocaleString()}%`,r.classList.toggle("in-profit",e>0),r.classList.toggle("in-loss",e<0),l.classList.toggle("in-profit",t>0),l.classList.toggle("in-loss",t<0),$.reveal(r.closest(".hk"),l.closest(".hk"))}else $.conceal(r.closest(".hk"),l.closest(".hk"));const p=s.querySelectorAll(".pe");for(let e=1;e<p.length;e++)p[e].remove();let k=0;const f=p[0];for(let t=0;t<d.length;t++){const c=d[t],o=f.cloneNode(!0);let r=0;t===d.length-1?r=Number((100-k).toFixed(2)):v>0&&(r=(c.invested/v*100).toFixed(2),k+=Number(r));const l=o.querySelector(".stockavgcal__current-column"),n=o.querySelector(".stockavgcal__current-pl-column"),a=o.querySelector(".stockavgcal__net-change-column"),u=o.querySelector(".stockavgcal__allocation-column");if(o.querySelector(".pt").textContent=`${h(t+1)} Purchase`,o.querySelector(".stockavgcal__buy-price-value").textContent=c.buyPrice.toLocaleString(),o.querySelector(".stockavgcal__quantity-value").textContent=c.quantity.toLocaleString(),o.querySelector(".stockavgcal__invested-value").textContent=Number(c.invested).toLocaleString(),o.querySelector(".stockavgcal__allocation-value").textContent=`${Number(r)}%`,"basic"===e?$.conceal(l,n,a,u):$.reveal(l,n,a,u),"advanced"===e&&m>0){const e=o.querySelector(".stockavgcal__current-pl-value"),t=o.querySelector(".stockavgcal__net-change-value"),r=(m*c.quantity).toFixed(2),l=(r-c.invested).toFixed(2),n=(l/c.invested*100).toFixed(2);o.querySelector(".stockavgcal__current-value").textContent=Number(r).toLocaleString(),e.textContent=`${l>=0?"+":""}${Number(l).toLocaleString()}`,t.textContent=`${n>=0?"+":""}${Number(n).toLocaleString()}%`,e.classList.toggle("in-profit",l>0),e.classList.toggle("in-loss",l<0),t.classList.toggle("in-profit",l>0),t.classList.toggle("in-loss",l<0)}else $.conceal(l,n,a);s.appendChild(o)}f.remove();const b=i.querySelector(".stockavgcal__cmp-column"),x=i.querySelector(".stockavgcal__total-column"),L=i.querySelector(".stockavgcal__total-pl-column"),C=i.querySelector(".stockavgcal__total-return-column");if("basic"===e?$.conceal(b,x,L,C):$.reveal(b,x,L,C),i.querySelector(".stockavgcal__average-buy-price-value").textContent=y,i.querySelector(".stockavgcal__total-quantity-value").textContent=_,i.querySelector(".stockavgcal__total-invested-value").textContent=S,"advanced"===e&&m>0){const e=m*g,t=e-v,c=t/v*100,o=i.querySelector(".stockavgcal__total-pl-value"),r=i.querySelector(".stockavgcal__total-return-value");i.querySelector(".stockavgcal__cmp-value").textContent=m.toLocaleString(),i.querySelector(".stockavgcal__total-value").textContent=Number(e).toLocaleString(),o.textContent=`${t>=0?"+":""}${Number(t.toFixed(2)).toLocaleString()}`,r.textContent=`${c>=0?"+":""}${Number(c.toFixed(2)).toLocaleString()}%`,o.classList.toggle("in-profit",t>0),o.classList.toggle("in-loss",t<0),r.classList.toggle("in-profit",t>0),r.classList.toggle("in-loss",t<0)}else $.conceal(b,x,L,C);$.reveal(u,s,i)}$.qs("#z").addEventListener("submit",(function(e){e.preventDefault();const t=$.qs("#tv").value;/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/.test(t)?window.location.href="/contact-us.html?email="+encodeURIComponent(t):alert("Please enter a valid email address.")})),m(),function(){e.addEventListener("change",(e=>{const t=e.target.value;t&&sessionStorage.setItem("currency-preference",t),k(t)})),n.addEventListener("click",(()=>{p()})),y.addEventListener("click",(()=>{f()})),d.addEventListener("click",(()=>{!function(){const e=$.qsa(".hd");for(const t of e){const e=t.querySelector(".stockavgcal__purchase-buy-price"),c=t.querySelector(".stockavgcal__purchase-quantity");e.value=0,c.value=0}t.textContent=0,c.textContent=0,o.textContent=0,a.value=0,$.conceal(r.closest(".hk"),l.closest(".hk"),u,s,i,g,v);const n=s.querySelectorAll(".pe");for(let e=1;e<n.length;e++)n[e].remove()}()}));for(const e of _)e.addEventListener("change",(e=>{m(e.target.value)}));const S=sessionStorage.getItem("currency-preference");S&&(e.value=S,k(S))}()}));